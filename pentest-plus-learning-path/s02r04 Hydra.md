# Hydra

*Also in Cyber Security 101 - section 9, room 1*

## [Task 1] Hydra Introduction

Hydra is a brute-force online password cracker. It takes a list and brute-forces authentication serices. Hydra supports various protocols, including:
- Asterisk
- AFP
- Cisco AAA, auth, enable
- CVS
- Firebird
- FTP
- HTTP (FORM-GET, FORM-POST, GET, HEAD, POST, PROXY)
- HTTPS (FORM-GET, FORM-POST, GET, HEAD, POST, Proxy)
- ICQ
- IMAP
- IRC
- LDAP
- MEMCACHED
- MongoDB, MS-SQL, MySQL

The Kali Hydra tool page contains more information on the options for each protoocl.

Tools like this demonstrate why you need a strong password - if your password is common and not complex, then it will be easily guesseed with a long-enough list of common passwords. If you're using something that has default login credentials, change them!

Hydra can be found on the AttackBox and in Kali. If you prefer to use another distribution, check the official repositories. You can use apt and dnf to install Hydra based on your distribution, and you can also check the THC-Hydra repository.

## [Task 2] Using Hydra

Start the attached VM and the AttackBox, then navigate to `http://MACHINE_IP`.

When we want to use Hydra, we have to specify a protocol/service that we're attacking. The command structure typically looks like this: `hydra -l (USERNAME) -P (PASSWORD_LIST) (THING_YOU_WANT_TO_BRUTE_FORCE)`. For FTP, this might be `hydra -l (USERNAME) -P (PASSWORD_LIST) ftp://MACHINE_IP`. Options will differ depending on what we're brute-forcing.

For SSH, we would use the command `hydra -l (USERNAME) -P (PASSWORD_LIST) (MACHINE_IP) -t 4 ssh`. The `-t` switch can be used to set the number of threads to spawn.

Hydra can be used to brute-force web forms as well. You'd have to know what kind of request is being made, whether it be a GET or POST method. You can use the Network tab in your browser's developers tools to see what request types are being made, as well as the source code.

A command you might use for this is `hydra -l (USERNAME) -P (WORDLIST) (MACHINE_IP) http-post-form "/:username=^USER^&password=^PASS^:F=incorrect" -V`.
- The login page is specified by `/`. This is the main IP address. We can change the specified page as needed.
- The `username` is the form field where the username is entered.
- The specified usernames will replace `^USER^`.
- The `password` is the form field where the password is entered, and the provided passwords will replace `^PASS^`.
- The `F=incorrect` portion indicates that "incorrect" will be a string in the server reply if the login fails.

If we go to `http://MACHINE_IP`, we see that it takes us to the `http://MACHINE_IP/login` for us to input login information. This will be important for us later! If we try to log in and check the Network tab, we see that there is indeed something being posted in an HTTP form:

![image](https://github.com/user-attachments/assets/336ad5f7-fb62-4090-bf0a-4a2325603eb3)

And the form fields are `username` and `password`:

![image](https://github.com/user-attachments/assets/92795299-3a2f-47fd-9e9a-a13f22a89572)

And here's what we see when we try to log in with an incorrect username/password combination:

![image](https://github.com/user-attachments/assets/c7ebb19f-a72e-4fe8-8893-1615199546f5)

This gives us enough information - we can use `incorrect` as the failure string, as in the example.

So let's set up the Hydra command: We'll use `hydra -l molly -P /usr/share/wordlists/rockyou.txt (MACHINE_IP) http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect" -V`. Doing this gives us...

![image](https://github.com/user-attachments/assets/16d430ea-ce9b-4f68-a7c2-142a9a562864)

We know that Molly's password is `sunshine`, so if we log in with this information, we get:

![image](https://github.com/user-attachments/assets/304d5a3d-cd86-40b6-83f1-a458bc3cb470)

**[Task 2, Question 1] Use Hydra to brute-force `molly`'s web password. What is flag 1?** - `THM{2673a7dd116de68e85c48ec0b1f2612e}`

Now let's get `molly`'s SSH password. The command we'd issue is `hydra -l molly -P /usr/share/wordlists/rockyou.txt (MACHINE_IP) -t 4 ssh`. This yields:

![image](https://github.com/user-attachments/assets/25c3556a-dc2c-459b-9fce-9668659e6e38)

The password here is `sunshine`, so we can run `ssh molly@(MACHINE_IP)`, log in with the password, and check the contents of `flag2.txt`:

![image](https://github.com/user-attachments/assets/076c850b-4756-4501-aea6-ccf6d12b4fbf)

**[Task 2, Question 2] Use Hydra to brute-force `molly`'s SSH password. What is flag 2?** - `THM{c8eeb0468febbadea859baeb33b2541b}`
