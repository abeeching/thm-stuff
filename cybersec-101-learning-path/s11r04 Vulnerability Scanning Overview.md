# Vulnerability Scanner Overview

## [Task 1] What are Vulnerabilities?

Weaknesses in a system are called _vulnerabilities_, and these could lead to significant issues in the future if not addressed in a timely fashion. The process of fixing the vulnerabilities is called _patching_. Digital devices can have vulnerbailities as a result of software programs and hardware issues, and these can be leveraged by an attacker to compromise the machine. Hackers are always trying to find vulnerabilities to exploit, and they're hard to find on your own unless you're actively seeking them out.

Our goal in this room is to learn how to hunt vulnerabilities and what tools we can use to automate this process.

**[Task 1, Question 1] What is the process of fixing the vulnerabilities called?** - Patching

## [Task 2] Vulnerability Scanning

Vulnerability scanning is the process of inspecting digital systems to find weaknesses. Organizations have critical information in their digital infrastructure, and so they must regularly scan systems and networks for vulnerabilities, since they can be leveraged to compromise their digital infrastructure. This can result in losses. Vulnerability scanning is important for many regulatory bodies, and some standards even advise performing vulnerability scanning quarterly/yearly.

The bigger a network is, the harder it is to spot vulnerabilities. Efficient vulnerability scanners exist to help perform automated vulnerability scans, making this more of a moot point nowadays. All you need to do is install the tool and give it an IP address for a host or a network range for a network; it'll do its thing and check for vulnerabilities from there.

Once vulnerabilities are identified, organizations can fix them by making changes to a software program or system. These are knwon as _patches_.

Vulnerability scans can be categorized in different ways. An authenticated scan requires the subject host's credentials and can provide more details than unauthenticated scans. This would be good for finding the threat surface within a network. Unauthenticated scans help identify the threat surface from outside the host, i.e., what an attacker would likely see.
- Authenticated scans:
  - Credentials must be provided
  - Identifies vulnerabilities that can be exploited by attackers who have access to the host
  - Provides deeper visibility into the target system by scanning its configuration and installed apps
  - Example: Scanning an internal database with its credentials
- Unauthenticated scans:
  - Does not require credentials, just an IP address
  - Identifies vulnerabilities that can be exploited by an external attacker having no access to the subject host
  - Less resource-intensive and straightforward to set up
  - Example: Scanning a public-facing site for vulnerabilities that can be exploited

Internal scans are conducted inside the network, whereas external scans are conducted from outside.
- Internal scans:
  - Conduct from inside network
  - Focus on vulnerabilities from inside the network
  - Identifies vulnerabilities that would be exposed to attackers once they got in
- External scans:
  - Conduct from outside network
  - Focus on vulnerabilities that can be exploited from outside the network
  - Identifies vulnerabilities exposed to attacker from outside network
 
The choice between all the scan types can vaery depending on what you need to do. Authenticated scans are usually used for internal scanning, whereas unauthenticated scans are usd for external scanning.

**[Task 2, Question 1] Which type of vulnerability scans require the credentials of the target host?** - authenticated

**[Task 2, Question 2] Which type of vulnerability scan focuses on identifying vulnerabilities that can be exploited from outside the network?** - external

## [Task 3] Tools for Vulnerability Scanning

There are many tools that can be used to perform vulnerability scanning:
- Nessus: An open-source project initially in 1998, later acquired by Tenable in 2005 and became proprietary. Extensive scanner and widely used by large enterprises. Has free and paid versions, with the free version offering limited features. Needs to be deployed and managed on premises
- Qualys: 1999, subscription-based vulnerability management solution. Provides compliance checks and asset management. Alerts on vulnerabilites found during continuous monitoring. Cloud-based platform, meaning there's no extra cost or effort to keep it up and running on physical hardware
- Nexpose: Rapid7, 2005 subscription-based solution. Continuously discovers new assets and does vulnerability scans on them. Gives risk scores depending on asset value and potential impact. Performs compliance checks against various standards. Offers both on-premises and hybrid deployment modes.
- OpenVAS (Open Vulnerability Assessment System): Open-source solution developed by Greenbone Security. Offers basic features with known vulnerabilities scanned through its database, less extensive, but is a pretty complete scanner. Benefical for small organizations and individual systems. This will be the tool we focus on here.

Almost all scanners offer reporting capabilities, so you can get a detailed report of what was found after each scan. This includes discovered vulnerabilities, risk scores, and descriptions. Some offer advanced reporting capabilities with remediation methods for all discovered vulnerabilities. You can export these reports in different formats.

When choosing a scanner, consider the scope, resources, depth of analysis, and other factors.

**[Task 3, Question 1] Is Nessus currently an open-source vulnerability scanner? (Yea/Nay)** - Nay

**[Task 3, Question 2] Which company developed the Nexpose vulnerability scanner?** - Rapid7

**[Task 3, Question 3] What is the name of the open-source vulnerability scanner developed by Greenbone Security?** - OpenVAS

## [Task 4] CVE and CVSS

CVE stands for Common Vulnerabilities and Exposures, and consists of unique numbers given to vulnerabilities. This system was set up by MITRE. Whenever a new vulnerability is discovered, they get a unique CVE number and they're published online in a CVE database to make people aware of these vulnerabilities. You can check CVE databases for previously-discovered vulnerabilities. Each CVE number has a specific format:
- CVE prefix: Every CVE number starts with "CVE".
- Year: The second part of each CVE nubmer contains the year it was discovered.
- Arbitrary digits: The last part of the CVE number contains some arbitrary digits.

One CVE number might be CVE-2024-9374. This tells us the CVE was discovered in 2024.

CVSS stands for Common Vulnerability Scoring System, and can be used to categorize a vulnerability's severity based on its impact, ease of exploitability, and other factors. The severity ranges are as follows:
- 0.0 to 3.9 = Low
- 4.0 to 6.9 = Medium
- 7.0 to 8.9 = High
- 9.0 to 10.0 = Critical

**[Task 4, Question 1] CVE stands for?** - Common Vulnerabilities and Exposures

**[Task 4, Question 2] Which organization developed CVE?** - MITRE Corporation

**[Task 4, Question 3] What would be the severity level of the vulnerability with a score of 5.3?** - Medium

## [Task 5] OpenVAS

Let's look at how to use OpenVAS. We can install it on, say, an Ubuntu machine... but it can be a pretty hectic process since there are a lot of dependencies. We'll use Docker to help with the installation process. Docker is a platform that lets you create and distribute packages of different applications, known as containers. Containers have all the dependencies already installed inside of it, so you don't need to worry about all the dependency stuff. OpenVAS has already been set up in the VM that we'll be opening next task.

The installation process is as follows:
- Run `sudo apt install docker.io`
- Run `sudo docker run -d -p 443:443 -name openvas mikesplain/openvas`

Once the installation process is complete, you can access the web interface by going to `https://127.0.0.1` in your browser. This takes you to the login page of OpenVAS, and you'll have to enter the correct credentials to access the interface. The dashboard gives you an overview of all vulnerability scans.

To run a scan, you need to create a task in the OpenVAS dashboard. Then we fill out the details of the task and execute it to run the scan.
1. Click the Tasks option available inside the Scans option on the dashboard.
2. Click the Star icon and then the New Task option.
3. Enter the name of the task and click the Scan Targets option.
4. Enter the name of the target machine and its IP address. Click Create.
5. You'll have many scan options available. Each scan option has its scope of scanning. You can study the details of each scan type and choose accordingly, then click Create.
6. The task is created. To start the scan, click the play button in the Actions option of the task.
7. It will take a few minutes to complete the scan, but once it's done, you'll se the status marked as Done. The visualizations in the Tasks dashboard will display some numbers indicating the severity of vulnerabilities found. To check the details, click the task name.
8. To see the details of all vulnerabilities discovered during the scan, click on the number indicating the count of vulnerabilities found in the subject host.
9. Then you'll have a list of vulnerabilities. You can click any of them to see more details, and you can export the results as reports as needed. You can fetch the reports in any format from the Tasks dashboard.

The questions below refer to screenshots in the task itself.

**[Task 5, Question 1] What is the IP address of the machine scanned in this task?** - `10.10.154.44`

**[Task 5, Question 2] How many vulnerabilities were discovered on this host?** - 13

## [Task 6] Practical Exercise

For our practical exercise this time, there was a reputable firm that conducted a scan on a server on its network that stores critical information. This was intended to enhance the security posture of the organization. The scan was conducted in OpenVAS, and the report was put on the desktop. We, as a security engineer, need to review this report and get some information. OpenVAS is pre-installed, and the scan is already done since those can take a while. If we did want to run the scan, we'd have to run the command `docker start openvas` and log in with the username "admin" and password "admin".

If we look at the report provided on the desktop, we see this high-severity alert:

![image](https://github.com/user-attachments/assets/381aa306-1842-4cbf-ad97-43eb6a200141)

We see it has a score of 10, which means this one's pretty rough!

**[Task 6, Question 1] What is the score of the single high-severity vulnerability found in the scan?** - 10

The suggested solution is provided above.

**[Task 6, Question 2] What is the solution suggested by OpenVAS for this vulnerability?** - Change the password of the mentioned account(s)
